{% extends 'base_with_navigation.html' %}

{% load staticfiles %}
{% block js %}
<script src={% static 'real_group/group_management.js' %}></script>
{% endblock %}

{% load guardian_tags %}
{% block content %}
	<div id="link_to_group_page">
		<a href={% url 'group_page' real_group_id=real_group.id %}>To Group Page</a>
	</div>
	<div class="member_list">
		<p>Manager List:</p>
		<div>
		{% for user in user_set %}
			{% get_obj_perms user for real_group as "perms" %}
			{% get_obj_perms request.user for real_group as "request_user_perms" %}
			{% if "real_group_management" in perms %}
			<div>
				<p>{{user.username}}
				{% if "real_group_ownership" not in perms and "real_group_ownership" in request_user_perms %}
				<a href="{% url 'process_user_permission' real_group_id=real_group.id user_info_id=user.userinfo.id decision="False" %}">Remove Manager</a>
				{% endif %}
				</p>
			</div>	
			{% endif %}
		{% endfor %}
		</div>

	</div>
	<div class="member_list">
		<p>User List:</p>
		<div>
		{% for user in user_set %}
			{% get_obj_perms user for real_group as "perms" %}
			{% if "real_group_management" not in perms and "real_group_membership" in perms %}
			<div>
				<p>{{user.username}}
				<a href={% url 'process_user_permission' real_group_id=real_group.id user_info_id=user.userinfo.id decision="True" %}>Set Manager</a> 
				<a href={% url 'delete_user_from_group' real_group_id=real_group.id user_info_id=user.userinfo.id %}>Remove</a>
				</p>
			</div>	
			{% endif %}

		{% endfor %}
		</div>
	</div>

	<div class="group_basic_info">
		<div id="display_group_name">
			Group Name: <span>{{real_group.name}}</span>
			<a href="#">[Change]</a>
		</div>
		<div id="modify_group_name">
			<p>Modify Group Name</p>
			<p class="error"></p>
			<form method="post" action={% url 'group_management_page' real_group_id=real_group.id %}>
				{{form_group_name.as_p}}
				<input type="submit" name="group_name_submit" value="Submit"/>
				<input type="button" value="Cancel"/>
			</form>	
		</div>
	</div>

	<div class="group_basic_info">
		<div id="display_group_description">
			Group Description: <span>{{real_group.description}}</span>
			<a href="#">[Change]</a>
		</div>
		<div id="modify_group_description">
			<p>Modify Group Description</p>
			<p class="error"></p>
			<form method="post" action={% url 'group_management_page' real_group_id=real_group.id %}>
				{{form_group_description.as_p}}
				<input type="submit" name="group_description_submit" value="Submit"/>
				<input type="button" value="Cancel"/>
			</form>	
		</div>
	</div>

	<div class="apply_confirm">
		<p>Add Group To Project</p>
		<p class="error"></p>
		<form method="post" action={% url 'group_management_page' real_group_id=real_group.id %}>
			{{form_apply_to_project.as_p}}
			<input type="submit" name="RTP_submit" value="Search"/>
		</form>	

		<div class="search_result">
		</div>
	
	</div>


	<div class="apply_confirm">
		<p>Add User</p>
		<p class="error"></p>
		<form method="post" action={% url 'group_management_page' real_group_id=real_group.id %}>
			{{form_add_user.as_p}}
			<input type="submit" name="RTU_submit" value="Search"/>
		</form>	

		<div class="search_result">
		</div>

	</div>
{% endblock %}
